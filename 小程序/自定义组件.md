# 自定义组件

## 使用

1. 创建自定义组件

创建components文件夹，在文件夹中创建自定义组件的文件夹，右键选择新建Component,这样就会自动生成 .js .json .wxml .wxss 四个文件夹。
![image](https://user-images.githubusercontent.com/72189350/208227500-a3c3c8e7-ba60-4556-8276-38d9a0473c19.png)

2. 如何引用

**局部引用**

在想要引用的页面中，在.json 文件中配置,my-test1组件名，后面跟着路径即可
```
// .json
{
  "usingComponents": {
    "my-test1": "/components/test/test"
  }
}

// .wxml
<my-test></my-test>
```

**全局引用**

在app.json中配置。
```
{
  "usingComponents": {
    "my-test": "/components/test/test"
  }
}
```

3. 组件和页面的区别

- 组件的.json文件中需要声明`component：true`
- 组件中.js文件调用的是`Component()`,页面.js文件调用的是`Page()`
- 组件中事件处理的函数需要定义在`methods`

## 自定义组件样式

组件样式相互隔离，并且不会被外界样式影响。也可以通过设置样式赖解除隔离

```
// 在组件中
Component({
  options: {
    styleIsolation: 'isolated' , // 'isolated' 隔离(默认)  'apply-shared' 外界页面会影响组件，组件不会影响页面 'shared' 互相影响
  }
})

// 或者在组件的.json文件中配置
{
  "styleIsolation": "isolated" , // 'isolated' 隔离(默认)  'apply-shared' 外界页面会影响组件，组件不会影响页面 'shared' 互相影响
}
```

## 数据，方法，属性

和vue类似，有一点区别是properties也是可读可写的。
```
<my-test max="6"></my-test>

/**
 * 组件的属性列表
 */
properties: {
  // max: Number // 1.简化写法
  max: {
    type: Number, 
    value: 10,  // 设置默认值
  }
},

/**
 * 组件的初始数据
 */
data: {
  count: 0,
},

/**
 * 组件的事件处理函数和自定义方法列表
 */
methods: {
  addCount() {
    if (this.data.count >= this.properties.max) return;
    this.setData({
      count : this.data.count + 1
    })
    this._showCount()
  },
  _showCount() {
    wx.showToast({
      title: 'count 是' + this.data.count,
      icon: 'none'
    })
  }
}
```

## 数据监听器

类似vue中的watch
```
<view>
  {{a}} + {{b}} = {{sum}}
</view>
<button bindtap="adda">adda</button>
<button bindtap="addb">addb</button>

/**
 * 组件的初始数据
 */
data: {
  a:0,
  b:0,
  sum:0,
},

/**
 *数据监听器
 */
observers: {
  'a,b':function() {   // 如果a或者b发送变化
    this.setData({
      sum : this.data.a + this.data.b
    })
  }
},
/**
 * 组件的方法列表
 */
methods: {
  adda() {
    this.setData({
      a: this.data.a + 1
    })
  },
  addb() {
    this.setData({
      b: this.data.b + 1
    })
  },
}
``
