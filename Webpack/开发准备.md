# 开发准备

## 安装Webpack

- node.js
- webpack
- webpack-cli

安装命令 `npm install webpack webpack cli --save`
执行打包命令 `webpack`
查找其它命令 `webpack --help`

## 自定义webpack.config.js

```Javascript
const path = require('path')  // node.js引入路径

module.exports = {
    entry: './src/index.js',
    output: {
        filename: 'bundle.js',
        path: path.resolve(__dirname,'./dist'),    // 只能用绝对路劲
    },
    
    mode: 'development',
    
    devloop:'inline-source-map',  // 精准定位报错代码的行数
}
```

1. entry :入口文件
2. output:打包后的出口文件
3. mode: 开发模式， mode 节点的可选值有两个，分别是： `development`  和  `production`
- `development`  为开发环境 不会对打包生成的文件进行代码压缩和性能优化 ，打包速度快，适合在开发阶段使用  。
- `production为` 生产环境， 会对打包生成的文件进行代码压缩和性能优化， 打包速度很慢，仅适合在项目发布阶段使用 。
4. devloop:是webpack的配置项，在这里用`inline-soucre-map`，可以在debug时精准定位报错代码的行数和问题。

## 插件

插件是webpack编译器在把代码进行打包时候用到的一些工具，比如webpack打包less代码，就需要loader加载器来帮忙。

## 入门插件的使用 
 
### HtmlWebpackPlugin
`html-webpack-plugin`是用来打包时，自动生成html文件，引入src链接的插件。

安装命令：`npm install html-webpack-plugin`

调用插件则是在 webpack.config.js 中，用 plugins = []

```Javascript
const path = require('path')  // node.js引入路径
const HtmlWebpackPlugin = require('html-webpack-plugin')  // 引入html-webpack-plugin 插件

module.exports = {
    entry: './src/index.js',
    output: {
        filename: 'bundle.js',
        path: path.resolve(__dirname,'./dist'),    // 只能用绝对路劲
        clean: true,                     // 在打包新的结点后，清除dist之前的文件
    },
    
    mode: 'development',

    plugins: [
        new HtmlWebpackPlugin({     // 使用插件
            template: './index.html',  // 指定模板
            filename: 'app.html',    // 设置文件名 
            inject: 'body',       // 把src的链接在body中引入
        })
    ]
}
```

### webpack-dev-server

这个插件的作用是，帮我们更新保存代码后，自动打包构建，并且文件并不是根据 output 节点指定的路径，打包一个文件在调用，而是会先保存在内存中，提高打包性能。

- 安装:`npm install webpack-dev-server -D`
- 调用：`npx webpack-dev-server`

```Javascript
module.exports = {
    ...
    devServer: {
        static: './dist'    // 调用指定路径
    }
}
```

## 资源模块
资源模块是我们导入资源时调用的方法
```Javascript
module.exports = {
    ...
    module: {   // 资源配置模块
        rules: [
            ....
        ]
    }
}
```

## asset

在webpack.config.js 中用module配置:

asset资源配置模块有四种类型:

- asset/resource 可以导出一个单独的文件，并给出一个url，就是打包完会创建一个单独的文件，然后调用时会用文件的url调用
- asset/inline 导出一个资源的data url 也就是base64字符串 ，不会单独创建文件
- asset/source 导出资源的源代码，不会单独创建文件
- asset 其实是在inline/resource上选择，但文件大于8k(默认)时，会选择resource

使用
```Javascript
module: {   // 资源配置模块
    rules: [
        {
            test: /\.png$/,     // 正则表达式筛选文件后缀类型
            type: 'asset/resource',   // 资源类型 ， resource 可以导出一个单独的文件，并给出一个url
            generator: {              // 也可以在 rules 中配置打包后的文件名和路径，比output优先级更高
                filename: 'images/img1.png',
            },
        },
        {
            test: /\.svg$/,
            type: 'asset/inline',    // 导出一个资源的data url 也就是base64字符串
        },
        {
            test: /\.txt$/,     
            type: 'asset/source'    // 导出资源的源代码
        },
        {
            test: /\.jpg$/,
            type: 'asset',         // asset 其实是在inline/resource上选择，但文件大于8k(默认)时，会选择resource
            parser: {              // 这个可以修改文件的默认上限，maxSize设置为4M
                dataUrlCondition:{           
                    maxSize: 4 * 1024 * 1024  // 4m
                }
            },
        }
    ]
}
```

output中资源模块的导出方式
```Javascript
output: {
    assetModuleFilename: 'images/[contenthash][ext]'  // 配置资源模块路径和名字
    // [contenthash] 是自动根据哈希值生成文件名 [ext] 是自动生成对应后缀 
},
```






